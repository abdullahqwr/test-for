# ğŸ—ï¸ Error Team - Complete Architecture Documentation

## ğŸ“ Architecture Diagram

```
                                 INTERNET
                                    â”‚
                                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     Azure Application Gateway (Public IP)         â”‚
        â”‚                                                   â”‚
        â”‚  â€¢ WAF Protection (optional)                      â”‚
        â”‚  â€¢ SSL/TLS Termination                            â”‚
        â”‚  â€¢ Path-based Routing                             â”‚
        â”‚  â€¢ Health Probes                                  â”‚
        â”‚                                                   â”‚
        â”‚  Managed by AGIC (runs inside AKS) â—„â”€â”€â”€â”€â”€â”€â”      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                        â”‚                                   â”‚
                        â–¼                                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
        â”‚               Azure Kubernetes Service (AKS)      â”‚      â”‚
        â”‚                                                   â”‚      â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â” â”‚
        â”‚  â”‚        Namespace: kube-system                  â”‚    â”‚ â”‚
        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚ â”‚
        â”‚  â”‚  â”‚  AGIC Pod (Ingress Controller)   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
        â”‚  â”‚  â”‚  â€¢ Watches Ingress resources     â”‚              â”‚ â”‚
        â”‚  â”‚  â”‚  â€¢ Programs App Gateway          â”‚              â”‚ â”‚
        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                           â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚        Namespace: errorteam (Applications)          â”‚ â”‚
        â”‚  â”‚                                                     â”‚ â”‚
        â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
        â”‚  â”‚   â”‚   Frontend Pod   â”‚   â”‚   Frontend Pod   â”‚     â”‚ â”‚
        â”‚  â”‚   â”‚   (React/Vite)   â”‚   â”‚   (React/Vite)   â”‚     â”‚ â”‚
        â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
        â”‚  â”‚            â”‚                       â”‚               â”‚ â”‚
        â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
        â”‚  â”‚                        â–¼                           â”‚ â”‚
        â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
        â”‚  â”‚              â”‚ Frontend Service â”‚                  â”‚ â”‚
        â”‚  â”‚              â”‚   (ClusterIP)    â”‚                  â”‚ â”‚
        â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
        â”‚  â”‚                                                     â”‚ â”‚
        â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
        â”‚  â”‚   â”‚   Backend Pod    â”‚   â”‚   Backend Pod    â”‚     â”‚ â”‚
        â”‚  â”‚   â”‚  (Spring Boot)   â”‚   â”‚  (Spring Boot)   â”‚     â”‚ â”‚
        â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
        â”‚  â”‚            â”‚                       â”‚               â”‚ â”‚
        â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
        â”‚  â”‚                        â–¼                           â”‚ â”‚
        â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
        â”‚  â”‚              â”‚ Backend Service  â”‚                  â”‚ â”‚
        â”‚  â”‚              â”‚   (ClusterIP)    â”‚                  â”‚ â”‚
        â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
        â”‚  â”‚                        â”‚                           â”‚ â”‚
        â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚ â”‚
        â”‚  â”‚              â”‚                    â”‚                â”‚ â”‚
        â”‚  â”‚              â–¼                    â–¼                â”‚ â”‚
        â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ â”‚
        â”‚  â”‚   â”‚   ConfigMaps     â”‚  â”‚    Secrets       â”‚      â”‚ â”‚
        â”‚  â”‚   â”‚  (App Config)    â”‚  â”‚  (DB Creds)      â”‚      â”‚ â”‚
        â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                           â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚        Namespace: monitoring (Observability)        â”‚ â”‚
        â”‚  â”‚                                                     â”‚ â”‚
        â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
        â”‚  â”‚   â”‚  Prometheus Pod  â”‚                             â”‚ â”‚
        â”‚  â”‚   â”‚  â€¢ Scrapes pods  â”‚                             â”‚ â”‚
        â”‚  â”‚   â”‚  â€¢ Stores metricsâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ â”‚
        â”‚  â”‚   â”‚  â€¢ 15d retention â”‚         â”‚                   â”‚ â”‚
        â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                   â”‚ â”‚
        â”‚  â”‚            â”‚                   â”‚                   â”‚ â”‚
        â”‚  â”‚            â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
        â”‚  â”‚            â”‚ â”‚ Scrapes Metrics From:         â”‚     â”‚ â”‚
        â”‚  â”‚            â”‚ â”‚ â€¢ Frontend pods               â”‚     â”‚ â”‚
        â”‚  â”‚            â”‚ â”‚ â€¢ Backend pods (actuator)     â”‚     â”‚ â”‚
        â”‚  â”‚            â”‚ â”‚ â€¢ Kubernetes API              â”‚     â”‚ â”‚
        â”‚  â”‚            â”‚ â”‚ â€¢ Kubernetes nodes            â”‚     â”‚ â”‚
        â”‚  â”‚            â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
        â”‚  â”‚            â–¼                                        â”‚ â”‚
        â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
        â”‚  â”‚   â”‚   Grafana Pod    â”‚                             â”‚ â”‚
        â”‚  â”‚   â”‚  â€¢ Dashboards    â”‚                             â”‚ â”‚
        â”‚  â”‚   â”‚  â€¢ Visualization â”‚                             â”‚ â”‚
        â”‚  â”‚   â”‚  â€¢ Alerting      â”‚                             â”‚ â”‚
        â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
        â”‚  â”‚            â”‚                                        â”‚ â”‚
        â”‚  â”‚            â–¼                                        â”‚ â”‚
        â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
        â”‚  â”‚   â”‚  Grafana Service â”‚                             â”‚ â”‚
        â”‚  â”‚   â”‚   (ClusterIP)    â”‚                             â”‚ â”‚
        â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
        â”‚  â”‚            â”‚                                        â”‚ â”‚
        â”‚  â”‚            â–¼                                        â”‚ â”‚
        â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
        â”‚  â”‚   â”‚ Grafana Ingress  â”‚ â—„â”€â”€â”€â”€â”€â”€ AGIC manages        â”‚ â”‚
        â”‚  â”‚   â”‚  (via AGIC)      â”‚                             â”‚ â”‚
        â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Azure Database for PostgreSQL Flexible Server   â”‚
        â”‚   â€¢ Private Endpoint                              â”‚
        â”‚   â€¢ Delegated Subnet                              â”‚
        â”‚   â€¢ Automatic Backups                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â”‚
                                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        Azure Monitor & Log Analytics              â”‚
        â”‚   â€¢ Application Insights                          â”‚
        â”‚   â€¢ Container Insights                            â”‚
        â”‚   â€¢ Performance Monitoring                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—‚ï¸ Resource Groups Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Azure Subscription                              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  errorteam-tfstate (ISOLATED)                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Storage Account: errorteamtfstate                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Container: errorteam-tfstate                     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Blob: terraform.tfstate                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ State Locking Enabled                            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Encryption: AES-256                              â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  errorteam-final-infra                                    â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Azure Container Registry: errorteamacr             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ errorteam-frontend:latest                        â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ errorteam-backend:latest                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Admin enabled                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Basic SKU                                        â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  errorteam-final-solution (Main Infrastructure)           â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Virtual Network: errorteam-vnet                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ CIDR: 10.1.0.0/16                                â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Subnet: aks-subnet (10.1.0.0/20)                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Subnet: db-subnet (10.1.16.0/24)                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Subnet: appgw-subnet (10.1.17.0/24)              â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Application Gateway: errorteam-appgw               â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ SKU: Standard_v2                                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Public IP: errorteam-appgw-pip                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Managed by AGIC                                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Health Probes: Automatic                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Backend Pools: Dynamic (AGIC)                    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  AKS Cluster: errorteam-aks-cluster                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Kubernetes: 1.28                                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Node Pool: 2-5 nodes (auto-scale)                â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ VM Size: Standard_D2s_v3                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Network: Azure CNI                               â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ AGIC: Enabled                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ ACR Pull: Enabled                                â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  PostgreSQL: errorteam-postgres                     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ SKU: B_Standard_B1ms                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Storage: 32 GB                                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Private Endpoint: Yes                            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Backup: 7 days                                   â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Log Analytics: errorteam-logs                      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Retention: 30 days                               â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Container Insights: Enabled                      â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Application Insights: errorteam-appinsights        â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Linked to Log Analytics                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ APM for Backend                                  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagrams

### 1. User Request Flow (via AGIC)

```
User Browser
     â”‚
     â”‚ HTTP/HTTPS
     â–¼
Application Gateway (Public IP)
     â”‚
     â”‚ AGIC routes based on path
     â”‚
     â”œâ”€â”€â–º /api/* â”€â”€â”€â”€â”€â”€â–º Backend Service â”€â”€â–º Backend Pods
     â”‚                        â”‚                    â”‚
     â”‚                        â”‚                    â–¼
     â”‚                        â”‚              PostgreSQL
     â”‚
     â””â”€â”€â–º /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Frontend Service â”€â”€â–º Frontend Pods
                              â”‚
                              â””â”€â”€â–º Calls /api/* (internal)
```

### 2. AGIC Configuration Flow

```
Developer creates/updates Ingress YAML
     â”‚
     â–¼
kubectl apply -f ingress.yaml
     â”‚
     â–¼
Kubernetes API Server
     â”‚
     â–¼
AGIC Pod (watches Ingress resources)
     â”‚
     â–¼
AGIC calls Azure API
     â”‚
     â–¼
Application Gateway automatically configured
     â”‚
     â”œâ”€â”€â–º Backend Pools updated
     â”œâ”€â”€â–º Health Probes created
     â”œâ”€â”€â–º Routing Rules applied
     â””â”€â”€â–º SSL/TLS configured
```

### 3. Monitoring Data Flow

```
Application Pods (Frontend & Backend)
     â”‚
     â”‚ Expose /metrics endpoint
     â”‚
     â–¼
Prometheus (scrapes every 15s)
     â”‚
     â”‚ Stores in TSDB (15 days retention)
     â”‚
     â–¼
Grafana queries Prometheus
     â”‚
     â”‚ Renders dashboards
     â”‚
     â–¼
User accesses Grafana via:
     â”œâ”€â”€â–º Port Forward (localhost:3000)
     â””â”€â”€â–º AGIC Ingress (grafana.errorteam.com)
```

### 4. CI/CD Pipeline Flow

```
Developer pushes code
     â”‚
     â–¼
GitHub Actions triggered
     â”‚
     â”œâ”€â”€â–º PR: Build + Test + Validate
     â”‚         â””â”€â”€â–º Terraform Plan (comment on PR)
     â”‚
     â””â”€â”€â–º Merge to main:
           â”‚
           â”œâ”€â”€â–º Build Docker images
           â”‚         â”‚
           â”‚         â”œâ”€â”€â–º Frontend (React/Vite)
           â”‚         â””â”€â”€â–º Backend (Spring Boot)
           â”‚
           â”œâ”€â”€â–º Push to ACR
           â”‚         â”‚
           â”‚         â””â”€â”€â–º errorteamacr.azurecr.io/errorteam-*:latest
           â”‚
           â”œâ”€â”€â–º Update K8s manifests
           â”‚
           â””â”€â”€â–º Deploy to AKS
                 â”‚
                 â””â”€â”€â–º Rolling update (zero downtime)
```

---

## ğŸ” Security Architecture

### Network Security

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Internet                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTPS (Port 443)
                         â”‚ HTTP (Port 80)
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Application Gateway (Public)                   â”‚
â”‚  â€¢ WAF Protection (optional)                                â”‚
â”‚  â€¢ DDoS Protection                                          â”‚
â”‚  â€¢ SSL/TLS Termination                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Private IP
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Virtual Network (10.1.0.0/16)                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  App Gateway Subnet (10.1.17.0/24)                  â”‚   â”‚
â”‚  â”‚  â€¢ NSG: Allow 65200-65535 (Gateway Manager)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  AKS Subnet (10.1.0.0/20)                           â”‚   â”‚
â”‚  â”‚  â€¢ Network Policy: Calico                           â”‚   â”‚
â”‚  â”‚  â€¢ NSG: Internal communication                      â”‚   â”‚
â”‚  â”‚  â€¢ Pod-to-pod encryption                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Database Subnet (10.1.16.0/24)                     â”‚   â”‚
â”‚  â”‚  â€¢ Service Delegation: PostgreSQL                   â”‚   â”‚
â”‚  â”‚  â€¢ NSG: Only from AKS subnet                        â”‚   â”‚
â”‚  â”‚  â€¢ Private Endpoint only                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Identity & Access Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Azure Active Directory                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€â”€â–º Service Principal (Terraform)
             â”‚    â€¢ Owner on errorteam-final-solution
             â”‚    â€¢ Contributor on errorteam-final-infra
             â”‚    â€¢ Contributor on errorteam-tfstate
             â”‚
             â”œâ”€â”€â–º AKS Managed Identity
             â”‚    â€¢ AcrPull on errorteamacr
             â”‚    â€¢ Network Contributor on VNet
             â”‚    â€¢ Contributor on App Gateway (for AGIC)
             â”‚
             â””â”€â”€â–º AGIC Managed Identity
                  â€¢ Read Ingress resources
                  â€¢ Write to App Gateway
```

### Secrets Management

```
Secrets stored in:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Azure Key Vault (optional, not yet configured)          â”‚
â”‚     â€¢ Database passwords                                    â”‚
â”‚     â€¢ ACR credentials                                       â”‚
â”‚     â€¢ SSL certificates                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Kubernetes Secrets (base64 encoded)                     â”‚
â”‚     â€¢ db-credentials                                        â”‚
â”‚     â€¢ acr-secret (docker-registry)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Terraform State (encrypted at rest)                     â”‚
â”‚     â€¢ Storage Account: AES-256 encryption                   â”‚
â”‚     â€¢ Access via storage account keys                       â”‚
â”‚     â€¢ State locking with blob lease                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Monitoring Architecture

### Metrics Collection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Metrics Sources                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Application Metrics:                                       â”‚
â”‚  â”œâ”€â”€â–º Backend: /actuator/prometheus (Spring Boot)          â”‚
â”‚  â”œâ”€â”€â–º Frontend: nginx metrics                              â”‚
â”‚  â””â”€â”€â–º Custom app metrics                                   â”‚
â”‚                                                             â”‚
â”‚  Infrastructure Metrics:                                    â”‚
â”‚  â”œâ”€â”€â–º Kubernetes API Server                                â”‚
â”‚  â”œâ”€â”€â–º Kubelet (node metrics)                               â”‚
â”‚  â”œâ”€â”€â–º cAdvisor (container metrics)                         â”‚
â”‚  â””â”€â”€â–º kube-state-metrics (K8s objects)                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Scrape every 15s
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Prometheus                                â”‚
â”‚  â€¢ Time Series Database                                     â”‚
â”‚  â€¢ 15-day retention                                         â”‚
â”‚  â€¢ PromQL query language                                    â”‚
â”‚  â€¢ Alert rules (future)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ PromQL queries
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Grafana                                  â”‚
â”‚  â€¢ Dashboards:                                              â”‚
â”‚    â”œâ”€â”€â–º Kubernetes Cluster                                 â”‚
â”‚    â””â”€â”€â–º BurgerBuilder Application                          â”‚
â”‚  â€¢ Alerts (email, Slack, etc.)                             â”‚
â”‚  â€¢ User authentication                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dual Monitoring Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Prometheus + Grafana        â”‚     Azure Monitor            â”‚
â”‚       (In-cluster)               â”‚       (Cloud-native)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚                              â”‚
â”‚  âœ“ Real-time metrics            â”‚  âœ“ Long-term storage         â”‚
â”‚  âœ“ Custom dashboards            â”‚  âœ“ Azure integration         â”‚
â”‚  âœ“ Application metrics          â”‚  âœ“ Compliance & audit        â”‚
â”‚  âœ“ Free (self-hosted)           â”‚  âœ“ Multi-region              â”‚
â”‚  âœ“ Full control                 â”‚  âœ“ Managed service           â”‚
â”‚                                  â”‚                              â”‚
â”‚  Use for:                        â”‚  Use for:                    â”‚
â”‚  â€¢ Developer debugging           â”‚  â€¢ Production monitoring     â”‚
â”‚  â€¢ Application profiling         â”‚  â€¢ Alerting & on-call        â”‚
â”‚  â€¢ Short-term analysis           â”‚  â€¢ Compliance reports        â”‚
â”‚  â€¢ Cost tracking                 â”‚  â€¢ Cross-service correlation â”‚
â”‚                                  â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ High Availability & Scalability

### Application Tier

```
Frontend: 2 replicas (auto-scale ready)
     â”œâ”€â”€â–º CPU threshold: 70%
     â”œâ”€â”€â–º Memory threshold: 80%
     â””â”€â”€â–º Min: 2, Max: 10 pods

Backend: 2 replicas (auto-scale ready)
     â”œâ”€â”€â–º CPU threshold: 70%
     â”œâ”€â”€â–º Memory threshold: 80%
     â””â”€â”€â–º Min: 2, Max: 10 pods

Load Balancing:
     â””â”€â”€â–º Application Gateway
          â”œâ”€â”€â–º Session affinity: Optional
          â”œâ”€â”€â–º Connection draining: 30s
          â””â”€â”€â–º Health checks: Every 30s
```

### Infrastructure Tier

```
AKS Cluster:
     â”œâ”€â”€â–º Node pool: 2-5 nodes (auto-scale)
     â”œâ”€â”€â–º VM Size: Standard_D2s_v3
     â”œâ”€â”€â–º Availability Zones: Can be enabled
     â””â”€â”€â–º Upgrade: Rolling (zero downtime)

Application Gateway:
     â”œâ”€â”€â–º SKU: Standard_v2 (auto-scale ready)
     â”œâ”€â”€â–º Capacity: 2 instances
     â””â”€â”€â–º Can scale to 125 instances

PostgreSQL:
     â”œâ”€â”€â–º High Availability: Can be enabled
     â”œâ”€â”€â–º Backup: 7 days
     â””â”€â”€â–º Point-in-time restore: Yes
```

---

## ğŸš€ Deployment Pipeline Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GitHub Repository                        â”‚
â”‚  â€¢ Source code                                              â”‚
â”‚  â€¢ Terraform files                                          â”‚
â”‚  â€¢ K8s manifests                                            â”‚
â”‚  â€¢ GitHub Actions workflows                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ On PR
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PR Validation Workflow                         â”‚
â”‚  â”œâ”€â”€â–º Validate Terraform syntax                            â”‚
â”‚  â”œâ”€â”€â–º Check for secrets in code                            â”‚
â”‚  â”œâ”€â”€â–º Validate K8s manifests                               â”‚
â”‚  â”œâ”€â”€â–º Run unit tests                                        â”‚
â”‚  â””â”€â”€â–º Terraform plan (post as comment)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ On merge to main
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Deployment Workflow                            â”‚
â”‚                                                             â”‚
â”‚  Step 1: Build                                              â”‚
â”‚  â”œâ”€â”€â–º Build frontend (npm build)                           â”‚
â”‚  â”œâ”€â”€â–º Build backend (mvn package)                          â”‚
â”‚  â””â”€â”€â–º Run tests                                             â”‚
â”‚                                                             â”‚
â”‚  Step 2: Containerize                                       â”‚
â”‚  â”œâ”€â”€â–º Build Docker image: frontend                         â”‚
â”‚  â”œâ”€â”€â–º Build Docker image: backend                          â”‚
â”‚  â””â”€â”€â–º Tag with git SHA                                      â”‚
â”‚                                                             â”‚
â”‚  Step 3: Push                                               â”‚
â”‚  â”œâ”€â”€â–º Push to ACR                                           â”‚
â”‚  â””â”€â”€â–º Push to Docker Hub (backup)                          â”‚
â”‚                                                             â”‚
â”‚  Step 4: Deploy Infrastructure (if changed)                 â”‚
â”‚  â”œâ”€â”€â–º Terraform plan                                        â”‚
â”‚  â””â”€â”€â–º Terraform apply                                       â”‚
â”‚                                                             â”‚
â”‚  Step 5: Deploy Application                                 â”‚
â”‚  â”œâ”€â”€â–º Update K8s deployments                               â”‚
â”‚  â”œâ”€â”€â–º kubectl rollout status                               â”‚
â”‚  â””â”€â”€â–º Health check                                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Cost Estimate (Monthly - East US)

| Resource | SKU | Quantity | Est. Cost |
|----------|-----|----------|-----------|
| AKS Cluster | Free tier | 1 | $0 |
| VM Nodes | Standard_D2s_v3 | 2-5 | ~$140-$350 |
| Application Gateway | Standard_v2 | 2 instances | ~$280 |
| PostgreSQL | B_Standard_B1ms | 1 | ~$25 |
| Storage Account | Standard LRS | 1 | ~$2 |
| ACR | Basic | 1 | ~$5 |
| Log Analytics | Pay-as-you-go | - | ~$10-50 |
| Bandwidth | Outbound | - | ~$10-20 |
| **TOTAL** | | | **~$472-$742/month** |

**Savings Tips:**
- Use B-series VMs for non-production
- Enable auto-scaling (scale to 0 after hours)
- Use Azure Reserved Instances (up to 72% savings)
- Delete resources when not in use

---

## ğŸ“ Next Steps

1. **Deploy Infrastructure**
   - Run setup-azure.sh
   - Initialize Terraform
   - Apply infrastructure

2. **Deploy Applications**
   - Push images to ACR
   - Deploy to AKS
   - Verify health

3. **Deploy Monitoring**
   - Run deploy-monitoring.sh
   - Access Grafana
   - View dashboards

4. **Configure DNS**
   - Point domain to App Gateway public IP
   - Update ingress hostnames
   - Enable SSL/TLS

5. **Production Hardening**
   - Change default passwords
   - Enable WAF
   - Configure backups
   - Set up alerting

---

**Error Team** | Complete Architecture | Azure AKS Infrastructure
Ready for production deployment! ğŸš€
